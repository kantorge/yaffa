let n=document.querySelector(".finalizeIcon");n&&n.addEventListener("click",function(){let e=document.createElement("form");e.setAttribute("method","POST"),e.setAttribute("action",window.route("transactions.createFromDraft"));let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","_token"),i.setAttribute("value",csrfToken),e.appendChild(i);let t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","transaction"),t.setAttribute("value",JSON.stringify(window.mail.transaction_data)),e.appendChild(t),t=document.createElement("input"),t.setAttribute("type","hidden"),t.setAttribute("name","mail_id"),t.setAttribute("value",window.mail.id),e.appendChild(t),document.body.appendChild(e),e.submit()});document.querySelector(".deleteIcon").addEventListener("click",function(){if(!confirm(__("Are you sure to want to delete this item?")))return;let e=document.getElementById("form-delete");e.action=window.route("received-mail.destroy",window.mail.id),e.submit()});const r=document.querySelector(".reprocessIcon");r&&r.addEventListener("click",function(){if(!confirm(__("Are you sure to want to reprocess this email? Current data will be overwritten.")))return;if($(this).hasClass("busy"))return!1;$(this).addClass("busy");const e=window.mail.id;axios.patch(window.route("api.received-mail.reset-processed",{receivedMail:e})).then(function(){location.reload()}).catch(function(i){let t=new CustomEvent("toast",{detail:{header:__("Error"),body:__("Error reseting email processed status: "+i),toastClass:"bg-danger"}});window.dispatchEvent(t),$(".busy[data-delete]").removeClass("busy")})});
