import"./dataTables.bootstrap5.509daac4.js";import"./dataTables.contextualActions.min.3129c0ea.js";import{S as r}from"./sweetalert2.esm.all.dd009341.js";import{t as c,a as s,_ as l}from"./helpers.35739ffe.js";import{f as u}from"./dataTableHelper.1c2d9edf.js";import"./app.ffd9927a.js";import"./tslib.es6.598c7c7a.js";const d="#table";window.table=$(d).DataTable({data:window.accounts,columns:[{data:"name",title:__("Name"),render:function(t,e,n){return e==="display"?`<div class="d-flex justify-content-start align-items-center">
                        <i class="hover-icon me-2 fa-fw fa-solid fa-ellipsis-vertical"></i>
                        <a href="${window.route("account-entity.show",{account_entity:n.id})}" title="${__("Show details")}">${t}</a>
                    </div>`:t}},{data:"active",title:__("Active"),render:function(t,e){return u(t,e)},className:"text-center activeIcon"},{data:"config.currency.name",title:__("Currency")},{data:"config.opening_balance",title:__("Opening balance"),render:function(t,e,n){return e==="display"?c(t,window.YAFFA.locale,n.config.currency):t},className:"dt-nowrap",searchable:!1,type:"num"},{data:"transactions_count",title:__("Transactions"),render:function(t,e,n){return e==="display"&&t>0?`<a href="${window.route("reports.transactions",{accounts:[n.id]})}"
                        title="${__("Show transactions")}"
                        >${t.toLocaleString(window.YAFFA.locale,{maximumFractionDigits:0,useGrouping:!0})}</a>`:t},type:"num"},{data:"config.account_group.name",title:__("Account group")},{data:"alias",title:__("Import alias"),render:function(t,e){return e==="display"?t?t.replace(`
`,"<br>"):__("Not set"):t}}],createdRow:function(t,e){e.alias||$("td:eq(6)",t).addClass("text-muted text-italic")},order:[[0,"asc"]],deferRender:!0,scrollY:"500px",scrollCollapse:!0,stateSave:!1,processing:!0,paging:!1,responsive:!0,initComplete:function(t){$(t.nTable).on("click","td.activeIcon > i",function(){let e=$(t.nTable).DataTable().row($(this).parents("tr"));if($(this).hasClass("fa-spinner"))return!1;$(this).removeClass().addClass("fa fa-spinner fa-spin"),$.ajax({type:"PUT",url:window.route("api.accountentity.updateActive",{accountEntity:e.data().id,active:e.data().active?0:1}),data:{_token:csrfToken},dataType:"json",context:this,success:function(n){window.accounts.filter(a=>a.id===n.id)[0].active=n.active},error:function(n){let a=new CustomEvent("toast",{detail:{header:__("Error"),headerSmall:s(e.data().id,__("Go to transaction")),body:__("Error while changing account active state."),toastClass:"bg-danger"}});window.dispatchEvent(a)},complete:function(n){e.invalidate()}})})}});table.contextualActions({contextMenuClasses:["text-primary"],deselectAfterAction:!0,contextMenu:{enabled:!0,isMulti:!1,headerRenderer:!1,triggerButtonSelector:".hover-icon"},buttonList:{enabled:!1},items:[{type:"option",title:__("Show details"),iconClass:"fa fa-magnifying-glass",action:function(t){window.location.href=window.route("account-entity.show",{account_entity:t[0].id})}},{type:"option",title:__("Edit"),iconClass:"fa fa-edit",action:function(t){window.location.href=window.route("account-entity.edit",{type:"account",account_entity:t[0].id})}},{type:"option",title:__("Show transactions"),iconClass:"fa fa-list",action:function(t){window.location.href=window.route("reports.transactions",{accounts:[t[0].id]})}},{type:"divider"},{type:"option",title:l("Delete"),iconClass:"fa fa-trash",contextMenuClasses:["text-danger"],isDisabled:function(t){return t.transactions_count>0},action:function(t){const e=t[0];r.fire({animation:!1,text:__("Are you sure to want to delete this item?"),icon:"warning",showCancelButton:!0,cancelButtonText:__("Cancel"),confirmButtonText:__("Confirm"),buttonsStyling:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-secondary ms-3"}}).then(n=>{!n.isConfirmed||axios.delete(window.route("api.accountentity.destroy",e.id)).then(a=>{window.accounts=window.accounts.filter(o=>o.id!==a.data.accountEntity.id),table.row(e).remove().draw();let i=new CustomEvent("toast",{detail:{header:__("Success"),body:__("Account deleted"),toastClass:"bg-success"}});window.dispatchEvent(i)}).catch(a=>{let i=new CustomEvent("toast",{detail:{header:__("Error"),body:__("Error while trying to delete account"),toastClass:"bg-danger"}});window.dispatchEvent(i)}).finally(()=>{})})}}]});$("input[name=table_filter_active]").on("change",function(){table.column(1).search(this.value).draw()});$("#table_filter_search_text").keyup(function(){table.search($(this).val()).draw()});
