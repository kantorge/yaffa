import"./dataTables.bootstrap5.509daac4.js";import"./dataTables.contextualActions.min.3129c0ea.js";import{S as g}from"./sweetalert2.esm.all.dd009341.js";import{t as a,m as d,i as y}from"./dataTableHelper.1c2d9edf.js";import{p as w,d as m,_ as t,i as C}from"./helpers.35739ffe.js";import{O as v}from"./OnboardingCard.0113cd56.js";import{c as _}from"./app.ffd9927a.js";import"./tslib.es6.598c7c7a.js";let r=!0;const l="#table";let c=$(l).DataTable({ajax:{url:"/api/transactions/get_scheduled_items/any",type:"GET",dataSrc:function(e){return r=!1,e.transactions.map(w).map(m)},deferRender:!0},columns:[{data:"transaction_schedule.rule",title:t("Schedule settings"),render:function(e){return`<div class="d-flex justify-content-start align-items-center">
                    <i class="hover-icon me-2 fa-fw fa-solid fa-ellipsis-vertical"></i><span>${e.toText()}</span>
                </div>`}},a.dateFromCustomField("transaction_schedule.start_date",t("Start date"),window.YAFFA.locale),a.dateFromCustomField("transaction_schedule.next_date",t("Next date"),window.YAFFA.locale),a.iconFromBooleanField("schedule",t("Schedule")),a.iconFromBooleanField("budget",t("Budget")),a.iconFromBooleanField("transaction_schedule.active",t("Active")),a.type,a.payee,a.category,a.amount,a.extra],createdRow:function(e,n){$(e).attr("data-id",n.id),n.transaction_schedule.next_date&&(n.transaction_schedule.next_date<new Date(new Date().setHours(0,0,0,0))?$(e).addClass("table-danger"):n.transaction_schedule.next_date<new Date(new Date().setHours(24,0,0,0))&&$(e).addClass("table-warning")),n.config_type==="standard"&&n.categories.length===0&&$("td",e).eq(8).addClass("text-muted text-italic")},drawCallback:function(){C()},order:[[1,"asc"]],select:{select:!0,info:!1,style:"os"},deferRender:!0,scrollY:"500px",scrollCollapse:!0,stateSave:!1,processing:!0,paging:!1});c.contextualActions({contextMenuClasses:["text-primary"],deselectAfterAction:!0,contextMenu:{enabled:!0,isMulti:!1,headerRenderer:!1,triggerButtonSelector:".hover-icon"},buttonList:{enabled:!1},items:[{type:"option",title:t("Edit and insert instance"),iconClass:"fa fa-pencil",contextMenuClasses:["text-success fw-bold"],action:function(e){window.location.href=window.route("transaction.open",{transaction:e[0].id,action:"enter"})},isHidden:function(e){return!e.schedule||!e.transaction_schedule.active}},{type:"option",title:t("Skip instance"),iconClass:"fa fa-forward",contextMenuClasses:["text-warning fw-bold"],action:function(e){const n=e[0].id;r=!0;let u=new CustomEvent("toast",{detail:{body:t("Skipping schedule instance for transaction #:transactionId",{transactionId:n}),toastClass:`bg-info toast-transaction-${n}`,delay:1/0}});window.dispatchEvent(u),window.axios.patch(window.route("api.transactions.skipScheduleInstance",{transaction:n})).then(function(s){let o=$(l).dataTable().api().row(function(p,b){return b.id===n}),i=w(s.data.transaction);i=m(i),o.data(i).draw();let f=new CustomEvent("toast",{detail:{header:t("Success"),body:t("Transaction instance skipped (#:transactionId)",{transactionId:n}),toastClass:"bg-success"}});window.dispatchEvent(f)}).catch(function(s){let o=new CustomEvent("toast",{detail:{header:t("Error"),body:t("Error skipping transaction (#:transactionId): :error",{transactionId:n,error:s}),toastClass:"bg-danger"}});window.dispatchEvent(o)}).finally(function(){r=!1,setTimeout(function(){let s=document.querySelector(`.toast-transaction-${n}`);new window.bootstrap.Toast(s).hide()},250)})},isHidden:function(e){return!e.schedule||!e.transaction_schedule.active}},{type:"divider"},{type:"option",title:t("Edit transaction"),iconClass:"fa fa-edit",action:function(e){window.location.href=route("transaction.open",{transaction:e[0].id,action:"edit",callback:"back"})}},{type:"option",title:t("Clone transaction"),iconClass:"fa fa-clone",action:function(e){window.location.href=route("transaction.open",{transaction:e[0].id,action:"clone"})}},{type:"option",title:t("Edit and create new schedule"),iconClass:"fa fa-calendar",action:function(e){window.location.href=route("transaction.open",{transaction:e[0].id,action:"replace"})}},{type:"divider"},{type:"option",title:t("Delete"),iconClass:"fa fa-trash",contextMenuClasses:["text-danger"],isDisabled:function(){return r},action:function(e){const n=e[0].id;r=!0,g.fire({animation:!1,text:t("Are you sure to want to delete this item?"),icon:"warning",showCancelButton:!0,cancelButtonText:t("Cancel"),confirmButtonText:t("Confirm"),buttonsStyling:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-secondary ms-3"}}).then(u=>{if(!u.isConfirmed){r=!1;return}let s=new CustomEvent("toast",{detail:{body:t("Deleting transaction #:transactionId",{transactionId:n}),toastClass:`bg-info toast-transaction-${n}`,delay:1/0}});window.dispatchEvent(s),window.axios.delete(window.route("api.transactions.destroy",{transaction:n})).then(function(){$(l).dataTable().api().row(function(f,p){return p.id===n}).remove().draw();let i=new CustomEvent("toast",{detail:{header:t("Success"),body:t("Transaction deleted (#:transactionId)",{transactionId:n}),toastClass:"bg-success"}});window.dispatchEvent(i)}).catch(function(o){let i=new CustomEvent("toast",{detail:{header:t("Error"),body:t("Error deleting transaction (#:transactionId): :error",{transactionId:n,error:o}),toastClass:"bg-danger"}});window.dispatchEvent(i)}).finally(function(){r=!1,setTimeout(function(){let o=document.querySelector(`.toast-transaction-${n}`);new window.bootstrap.Toast(o).hide()},250)})})}}]});d(c,3,"table_filter_schedule");d(c,4,"table_filter_budget");d(c,5,"table_filter_active");d(c,6,"table_filter_transaction_type");document.getElementById("table_filter_active_yes").click();y(c);window.onboardingTourSteps=[{element:"#cardFilters",popover:{title:t("Apply filters"),description:t("Use these controls to narrow down the list of transactions.")}},{element:l,popover:{title:t("Actions"),description:t("Right click on a transaction to open a context menu with actions.")}}];const h=_({});h.component("onboarding-card",v);h.mount("#onboarding-card");
